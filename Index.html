                this.senha = '';
            } else {
                alert("Senha incorreta!");
            }
        },
        
        sair() {
            this.admin = false;
            this.view = 'home';
        },
        
        uploadVideo(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Limitar tamanho do vídeo (opcional)
            if (file.size > 50 * 1024 * 1024) { // 50MB
                alert("Vídeo muito grande! Máximo 50MB.");
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                this.form.video = e.target.result;
            };
            reader.readAsDataURL(file);
            event.target.value = ''; // Reset input
        },
        
        uploadFotos(event) {
            const files = Array.from(event.target.files);
            const fotosRestantes = 10 - this.form.fotos.length;
            
            if (files.length > fotosRestantes) {
                alert(`Você só pode adicionar mais ${fotosRestantes} fotos.`);
                files.splice(fotosRestantes);
            }
            
            files.forEach(file => {
                if (!file.type.includes('image/')) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    this.form.fotos.push(e.target.result);
                };
                reader.readAsDataURL(file);
            });
            
            event.target.value = ''; // Reset input
        },
        
        removerFoto(index) {
            this.form.fotos.splice(index, 1);
        },
        
        salvar() {
            if (!this.podeSalvar) {
                alert("Preencha o título e adicione entre 1 e 10 fotos!");
                return;
            }
            
            if (this.form.id) {
                // Editar
                const index = this.imoveis.findIndex(i => i.id === this.form.id);
                this.imoveis[index] = {...this.form};
            } else {
                // Novo
                this.form.id = Date.now();
                this.imoveis.push({...this.form});
            }
            
            localStorage.setItem("imoveis", JSON.stringify(this.imoveis));
            this.limparForm();
            this.view = 'admin';
        },
        
        editar(index) {
            this.form = JSON.parse(JSON.stringify(this.imoveis[index]));
            this.view = 'cadastro';
        },
        
        apagar(index) {
            if (confirm("Deseja remover este imóvel?")) {
                this.imoveis.splice(index, 1);
                localStorage.setItem("imoveis", JSON.stringify(this.imoveis));
                this.atualizarLista();
            }
        },
        
        cancelar() {
            this.limparForm();
            this.view = 'admin';
        },
        
        filtrar() {
            this.filtrados = this.imoveis.filter(i => {
                return (!this.filtroCidade || i.cidade === this.filtroCidade) &&
                       (!this.filtroTipo || i.tipo === this.filtroTipo) &&
                       (!this.filtroMin || i.valor >= this.filtroMin) &&
                       (!this.filtroMax || i.valor <= this.filtroMax);
            });
            this.view = 'home';
        },
        
        ver(im) {
            this.sel = im;
            this.fotoIndex = 0;
            this.detalhes = true;
        },
        
        nextFoto() {
            if (this.fotoIndex < this.sel.fotos.length - 1) {
                this.fotoIndex++;
            }
        },
        
        prevFoto() {
            if (this.fotoIndex > 0) {
                this.fotoIndex--;
            }
        },
        
        atualizarLista() {
            localStorage.setItem("imoveis", JSON.stringify(this.imoveis));
            this.filtrados = this.imoveis;
        },
        
        limparForm() {
            this.form = {
                id: null,
                titulo: '',
                bairro: '',
                cidade: '',
                tipo: 'venda',
                valor: '',
                descricao: '',
                quartos: '',
                banheiros: '',
                vagas: '',
                area: '',
                condominio: '',
                iptu: '',
                fotos: [],
                video: null
            };
        },
        
        formatarValor(valor) {
            return Number(valor).toLocaleString('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
    }
});

app.mount("#app");
</script>

</body>
</html>
